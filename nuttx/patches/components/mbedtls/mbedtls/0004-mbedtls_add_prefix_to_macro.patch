diff --git a/library/ecp.c b/library/ecp.c
index 03e4505fe03a18dd146aeccb067fbe00c1c8709d..0b8de4bb72fe085772b951c256c2a5f49be696ec 100644
--- a/library/ecp.c
+++ b/library/ecp.c
@@ -294,7 +294,7 @@ int esp_mbedtls_ecp_check_budget(const mbedtls_ecp_group *grp,
             if (rs_ctx->SUB == NULL)                                       \
             return MBEDTLS_ERR_ECP_ALLOC_FAILED;                     \
                                                                       \
-            ecp_restart_## SUB ##_init(rs_ctx->SUB);                      \
+            esp_ecp_restart_## SUB ##_init(rs_ctx->SUB);                      \
         }                                                                   \
 } while (0)
 
@@ -304,7 +304,7 @@ int esp_mbedtls_ecp_check_budget(const mbedtls_ecp_group *grp,
         if (rs_ctx != NULL && rs_ctx->SUB != NULL &&                        \
             ret != MBEDTLS_ERR_ECP_IN_PROGRESS)                            \
         {                                                                   \
-            ecp_restart_## SUB ##_free(rs_ctx->SUB);                      \
+            esp_ecp_restart_## SUB ##_free(rs_ctx->SUB);                      \
             esp_mbedtls_free(rs_ctx->SUB);                                    \
             rs_ctx->SUB = NULL;                                             \
         }                                                                   \
